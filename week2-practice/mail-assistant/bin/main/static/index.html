<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>Local AI Mail & DevDoc Console</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background-color: #f5f5f7;
            color: #111827;
        }

        .app-root {
            max-width: 1120px;
            margin: 32px auto;
            padding: 24px;
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 18px 45px rgba(15, 23, 42, 0.08);
        }

        .app-header h1 {
            margin: 0 0 6px;
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .subtitle {
            margin: 0 0 20px;
            font-size: 13px;
            color: #6b7280;
        }

        .agent-grid {
            display: grid;
            grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
            gap: 18px;
        }

        .agent-card {
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            padding: 16px 18px 18px;
            background: #f9fafb;
        }

        .agent-card:nth-child(1) {
            background: #fefefe;
        }

        .agent-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .agent-title {
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
            color: #111827;
        }

        .agent-tag {
            font-size: 10px;
            padding: 2px 7px;
            border-radius: 999px;
            background: #dbeafe;
            color: #1d4ed8;
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }

        .agent-desc {
            margin: 0;
            font-size: 12px;
            color: #6b7280;
        }

        .section {
            margin-top: 14px;
        }

        .section-title {
            font-size: 13px;
            margin-bottom: 6px;
            font-weight: 600;
            color: #374151;
        }

        label {
            display: block;
            font-size: 12px;
            margin-bottom: 4px;
            color: #4b5563;
        }

        textarea,
        input,
        select {
            width: 100%;
            padding: 8px 10px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            font-family: inherit;
            font-size: 13px;
            resize: vertical;
            background: #ffffff;
        }

        textarea:focus,
        input:focus,
        select:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.15);
        }

        textarea {
            min-height: 90px;
        }

        .row {
            display: flex;
            gap: 10px;
        }

        .row > .col {
            flex: 1;
        }

        .hint {
            font-size: 11px;
            color: #9ca3af;
            margin-top: 4px;
        }

        .buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
            margin-bottom: 6px;
        }

        button {
            border-radius: 999px;
            border: none;
            padding: 7px 16px;
            font-size: 13px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background-color: #2563eb;
            color: #ffffff;
            font-weight: 500;
        }

        button.secondary {
            background-color: #e5e7eb;
            color: #111827;
        }

        button:disabled {
            opacity: 0.65;
            cursor: default;
        }

        .output-title {
            font-size: 11px;
            margin-top: 4px;
            margin-bottom: 4px;
            color: #6b7280;
        }

        .output {
            margin-top: 2px;
            padding: 10px 12px;
            border-radius: 8px;
            background-color: #111827;
            border: 1px solid #020617;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 260px;
            overflow: auto;
            color: #e5e7eb;
        }

        .output-empty {
            opacity: 0.6;
            font-style: italic;
        }

        .error {
            color: #fecaca;
        }

        @media (max-width: 900px) {
            .app-root {
                margin: 12px;
                padding: 16px;
            }

            .agent-grid {
                grid-template-columns: minmax(0, 1fr);
            }
        }
    </style>
</head>
<body>
<div class="app-root">
    <header class="app-header">
        <h1>Local AI Agents</h1>
        <p class="subtitle">ì´ë©”ì¼ ì‘ì„±ê³¼ DevDoc Q&Aë¥¼ í•œ í™”ë©´ì—ì„œ ê°„ë‹¨í•˜ê²Œ ì‹¤í—˜í•´ ë³´ì„¸ìš”.</p>
    </header>

    <main class="agent-grid">
        <!-- Email Agent -->
        <section class="agent-card" id="email-agent">
            <div class="agent-header">
                <div>
                    <div class="agent-title">
                        <span>ğŸ“§ Email Agent</span>
                    </div>
                    <p class="agent-desc">í•œêµ­ì–´ ì´ˆì•ˆì„ ê¸°ë°˜ìœ¼ë¡œ ì˜ì–´ ë©”ì¼ì„ ë§Œë“¤ê³ , ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ë§ˆì§€ë§‰ ê²€í† ê¹Œì§€ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
                <span class="agent-tag">MAIL</span>
            </div>

            <div class="section">
                <div class="section-title">1. í•œêµ­ì–´ â†’ ì˜ì–´ ë©”ì¼ ì´ˆì•ˆ</div>
                <label for="email-korean-draft">í•œêµ­ì–´ ë©”ì¼ ì´ˆì•ˆ</label>
                <textarea
                        id="email-korean-draft"
                        placeholder="ì˜ˆ: ì§€ë‚œ ì¥ì• ì™€ í›„ì† ì¡°ì¹˜ì— ëŒ€í•´ ì •ë¦¬í•´ì„œ ê³ ê°ì‚¬ì— ê³µìœ í•˜ëŠ” ë©”ì¼ì„ ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤. ë„ˆë¬´ ê³µê²©ì ìœ¼ë¡œ ëŠê»´ì§€ì§€ ì•Šê²Œ, í•˜ì§€ë§Œ ì±…ì„ê³¼ ì¼ì •ì€ ë¶„ëª…íˆ ë“œëŸ¬ë‚˜ê²Œ ì¨ ì£¼ì„¸ìš”.">
                </textarea>
                <p class="hint">ë©”ì¼ì˜ ëª©ì , ìƒëŒ€ë°©, ë§íˆ¬ì— ëŒ€í•œ ëŒ€ëµì ì¸ ëŠë‚Œì„ ê°™ì´ ì ì–´ ì£¼ë©´ ë” ì¢‹ìŠµë‹ˆë‹¤.</p>
            </div>

            <div class="section row">
                <div class="col">
                    <label for="email-tone">tone (ë§íˆ¬)</label>
                    <select id="email-tone">
                        <option value="soft">soft â€” ë¶€ë“œëŸ½ê²Œ</option>
                        <option value="formal">formal â€” ê²©ì‹ ìˆê²Œ</option>
                        <option value="direct">direct â€” ì§ì„¤ì ìœ¼ë¡œ</option>
                    </select>
                </div>
                <div class="col">
                    <label for="email-mail-type">mailType (ë©”ì¼ ìœ í˜•)</label>
                    <select id="email-mail-type">
                        <option value="AUTO">AUTO â€” ìë™ ê°ì§€</option>
                        <option value="NEW">NEW â€” ì‹ ê·œ ë©”ì¼</option>
                        <option value="REPLY">REPLY â€” íšŒì‹ </option>
                        <option value="APOLOGY">APOLOGY â€” ì‚¬ê³¼ ë©”ì¼</option>
                        <option value="REMINDER">REMINDER â€” ë¦¬ë§ˆì¸ë“œ</option>
                    </select>
                </div>
            </div>

            <div class="section">
                <label for="email-additional-context">ì¶”ê°€ ë°°ê²½ / ìš”ì²­ ì‚¬í•­ (ì„ íƒ)</label>
                <textarea
                        id="email-additional-context"
                        placeholder="ì˜ˆ: ìƒëŒ€ íŒ€ì€ ìš°ë¦¬ ì‹œìŠ¤í…œì„ ì˜ ëª¨ë¦…ë‹ˆë‹¤. ì¥ì•  ì›ì¸ ì„¤ëª…ì€ ë„ˆë¬´ ê¸°ìˆ ì ì´ì§€ ì•Šê²Œ, ëŒ€ì‹  í›„ì† ì•¡ì…˜ê³¼ ì¬ë°œ ë°©ì§€ì— ì´ˆì ì„ ë§ì¶° ì£¼ì„¸ìš”.">
                </textarea>
            </div>

            <div class="section">
                <div class="buttons">
                    <button id="btn-generate-email">
                        <span>ì˜ì–´ ë©”ì¼ ì´ˆì•ˆ ìƒì„±</span>
                    </button>
                </div>
                <div class="output-title">ìƒì„±ëœ ì˜ì–´ ë©”ì¼ / ë©”íƒ€ ì •ë³´</div>
                <div id="email-draft-output" class="output output-empty">ì•„ì§ ìƒì„±ëœ ë©”ì¼ì´ ì—†ìŠµë‹ˆë‹¤.</div>
            </div>

            <div class="section">
                <div class="section-title">2. ë©”ì¼ ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
                <label for="email-english-mail">ì²´í¬í•  ì˜ì–´ ë©”ì¼ ë‚´ìš©</label>
                <textarea
                        id="email-english-mail"
                        placeholder="ìœ„ì—ì„œ ìƒì„±ëœ ë©”ì¼ì´ ìë™ìœ¼ë¡œ ë“¤ì–´ì˜¤ê±°ë‚˜, ì§ì ‘ ì‘ì„±í•œ ì˜ì–´ ë©”ì¼ì„ ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”.">
                </textarea>

                <div class="buttons">
                    <button id="btn-email-checklist" class="secondary">
                        <span>ì²´í¬ë¦¬ìŠ¤íŠ¸ í™•ì¸</span>
                    </button>
                </div>

                <div class="output-title">ì²´í¬ë¦¬ìŠ¤íŠ¸ ê²°ê³¼</div>
                <div id="email-checklist-output" class="output output-empty">ì²´í¬ë¦¬ìŠ¤íŠ¸ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
            </div>
        </section>

        <!-- DevDoc Agent -->
        <section class="agent-card" id="devdoc-agent">
            <div class="agent-header">
                <div>
                    <div class="agent-title">
                        <span>ğŸ“š DevDoc Agent</span>
                    </div>
                    <p class="agent-desc">ë°±ì—”ë“œ ê°œë°œ ê´€ì ì—ì„œ Q&Aë¥¼ ë°›ê³ , í•™ìŠµìš© ë…¸íŠ¸ë„ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.</p>
                </div>
                <span class="agent-tag">DEVDOC</span>
            </div>

            <div class="section">
                <div class="section-title">1. Q&A</div>
                <label for="devdoc-question">ì§ˆë¬¸ (question)</label>
                <textarea
                        id="devdoc-question"
                        placeholder="ì˜ˆ: Spring Bootì—ì„œ ì •ì  ë¦¬ì†ŒìŠ¤ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì„œë¹™í•˜ê³ , ìºì‹± ì „ëµì„ ì–´ë–»ê²Œ ì¡ìœ¼ë©´ ì¢‹ì„ì§€ ì„¤ëª…í•´ ì£¼ì„¸ìš”.">
                </textarea>

                <div class="row">
                    <div class="col">
                        <label for="devdoc-persona">persona (ì„ íƒ)</label>
                        <input
                                id="devdoc-persona"
                                type="text"
                                placeholder="ì˜ˆ: Java ë°±ì—”ë“œ 5ë…„ì°¨ ê°œë°œìë¥¼ ëŒ€ìƒìœ¼ë¡œ ì„¤ëª…í•´ ì£¼ì„¸ìš”.">
                    </div>
                    <div class="col">
                        <label for="devdoc-topic-hint">topicHint (ì„ íƒ)</label>
                        <input
                                id="devdoc-topic-hint"
                                type="text"
                                placeholder="ì˜ˆ: Spring Boot static resource, CDN, cache-control">
                    </div>
                </div>

                <div class="buttons">
                    <button id="btn-devdoc-qa">
                        <span>Q&A ì‹¤í–‰</span>
                    </button>
                </div>

                <div class="output-title">Q&A ê²°ê³¼ (ìš”ì•½ / ìƒì„¸ / ì°¸ê³  ë¬¸ì¥)</div>
                <div id="devdoc-qa-output" class="output output-empty">ì—¬ê¸°ì— Q&A ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>
            </div>

            <div class="section">
                <div class="section-title">2. í•™ìŠµ ë…¸íŠ¸ ìƒì„±</div>
                <div class="row">
                    <div class="col">
                        <label for="devdoc-topic">topic</label>
                        <input
                                id="devdoc-topic"
                                type="text"
                                placeholder="ì˜ˆ: LangChain4jë¡œ RAG êµ¬ì„±í•˜ê¸°">
                    </div>
                    <div class="col">
                        <label for="devdoc-note-persona">persona (ì„ íƒ)</label>
                        <input
                                id="devdoc-note-persona"
                                type="text"
                                placeholder="ì˜ˆ: Java ì£¼ë‹ˆì–´ ì„œë²„ ê°œë°œì">
                    </div>
                </div>

                <div class="buttons">
                    <button id="btn-devdoc-note" class="secondary">
                        <span>í•™ìŠµ ë…¸íŠ¸ ìƒì„±</span>
                    </button>
                </div>

                <div class="output-title">ìƒì„±ëœ í•™ìŠµ ë…¸íŠ¸ (Markdown)</div>
                <div id="devdoc-note-output" class="output output-empty">ìƒì„±ëœ í•™ìŠµ ë…¸íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
            </div>
        </section>
    </main>
</div>

<script>
    function setLoading(button, isLoading) {
        if (!button) return;
        if (isLoading) {
            button.dataset.originalText = button.textContent;
            button.textContent = "ì²˜ë¦¬ ì¤‘...";
            button.disabled = true;
        } else {
            if (button.dataset.originalText) {
                button.textContent = button.dataset.originalText;
            }
            button.disabled = false;
        }
    }

    async function postJson(url, body, outputElement, button) {
        if (!outputElement) return;
        setLoading(button, true);
        outputElement.classList.remove("output-empty");
        outputElement.textContent = "ìš”ì²­ ì¤‘...";
        try {
            const response = await fetch(url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(body)
            });

            const text = await response.text();
            let parsed;

            try {
                parsed = JSON.parse(text);
            } catch (_) {
                parsed = text;
            }

            if (!response.ok) {
                outputElement.innerHTML =
                    "<span class='error'>ìš”ì²­ ì‹¤íŒ¨ (" + response.status + ")</span>\n" +
                    (typeof parsed === "string" ? parsed : JSON.stringify(parsed, null, 2));
                return;
            }

            if (typeof parsed === "string") {
                outputElement.textContent = parsed;
            } else {
                outputElement.textContent = JSON.stringify(parsed, null, 2);
            }
        } catch (e) {
            outputElement.innerHTML = "<span class='error'>ì—ëŸ¬:</span> " + e;
        } finally {
            setLoading(button, false);
        }
    }

    // Email Agent: ì´ˆì•ˆ ìƒì„±
    (function setupEmailDraft() {
        const btn = document.getElementById("btn-generate-email");
        const koreanDraftEl = document.getElementById("email-korean-draft");
        const toneEl = document.getElementById("email-tone");
        const mailTypeEl = document.getElementById("email-mail-type");
        const contextEl = document.getElementById("email-additional-context");
        const outputEl = document.getElementById("email-draft-output");
        const englishMailEl = document.getElementById("email-english-mail");

        if (!btn) return;

        btn.addEventListener("click", async () => {
            const body = {
                koreanDraft: (koreanDraftEl.value || "").trim(),
                tone: toneEl.value || "soft",
                mailType: mailTypeEl.value || "AUTO",
                additionalContext: (contextEl.value || "").trim()
            };

            await postJson("/api/agent/email/draft", body, outputEl, btn);

            // ì‘ë‹µì´ JSONì´ê³  finalEnglishMailì´ ìˆìœ¼ë©´ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì…ë ¥ì°½ì— ìë™ ë°˜ì˜
            try {
                const text = outputEl.textContent || "";
                const parsed = JSON.parse(text);
                if (parsed && typeof parsed.finalEnglishMail === "string") {
                    englishMailEl.value = parsed.finalEnglishMail;
                }
            } catch (_) {
                // JSON íŒŒì‹± ì—ëŸ¬ëŠ” ë¬´ì‹œ
            }
        });
    })();

    // Email Agent: ì²´í¬ë¦¬ìŠ¤íŠ¸
    (function setupEmailChecklist() {
        const btn = document.getElementById("btn-email-checklist");
        const englishMailEl = document.getElementById("email-english-mail");
        const outputEl = document.getElementById("email-checklist-output");

        if (!btn) return;

        btn.addEventListener("click", async () => {
            const body = {
                englishMail: (englishMailEl.value || "").trim()
            };

            await postJson("/api/agent/email/checklist", body, outputEl, btn);
        });
    })();

    // DevDoc Agent: Q&A
    (function setupDevDocQa() {
        const btn = document.getElementById("btn-devdoc-qa");
        const questionEl = document.getElementById("devdoc-question");
        const personaEl = document.getElementById("devdoc-persona");
        const topicHintEl = document.getElementById("devdoc-topic-hint");
        const outputEl = document.getElementById("devdoc-qa-output");

        if (!btn) return;

        btn.addEventListener("click", async () => {
            const body = {
                question: (questionEl.value || "").trim(),
                persona: (personaEl.value || "").trim(),
                topicHint: (topicHintEl.value || "").trim()
            };

            await postJson("/api/agent/devdoc/qa", body, outputEl, btn);
        });
    })();

    // DevDoc Agent: í•™ìŠµ ë…¸íŠ¸
    (function setupDevDocNote() {
        const btn = document.getElementById("btn-devdoc-note");
        const topicEl = document.getElementById("devdoc-topic");
        const personaEl = document.getElementById("devdoc-note-persona");
        const outputEl = document.getElementById("devdoc-note-output");

        if (!btn) return;

        btn.addEventListener("click", async () => {
            const body = {
                topic: (topicEl.value || "").trim(),
                persona: (personaEl.value || "").trim()
            };

            await postJson("/api/agent/devdoc/note", body, outputEl, btn);
        });
    })();
</script>
</body>
</html>

