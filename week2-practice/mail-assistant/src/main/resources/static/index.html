<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>Local AI Agents Console</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background-color: #f5f5f7;
            color: #222;
        }

        .app-root {
            max-width: 1080px;
            margin: 32px auto;
            padding: 24px;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.06);
        }

        h1 {
            margin-top: 0;
            margin-bottom: 4px;
            font-size: 24px;
        }

        .subtitle {
            margin: 0 0 16px;
            font-size: 13px;
            color: #666;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 16px;
        }

        .tab {
            padding: 10px 16px;
            cursor: pointer;
            font-size: 14px;
            border-bottom: 2px solid transparent;
            display: flex;
            align-items: center;
            gap: 6px;
            color: #555;
        }

        .tab:hover {
            background-color: #f7f7f9;
        }

        .tab.active {
            border-bottom-color: #2563eb;
            color: #111827;
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            margin-bottom: 18px;
        }

        .section-title {
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }

        label {
            display: block;
            font-size: 13px;
            margin-bottom: 4px;
            color: #4b5563;
        }

        textarea,
        input,
        select {
            width: 100%;
            padding: 8px 10px;
            border-radius: 6px;
            border: 1px solid #d1d5db;
            font-family: inherit;
            font-size: 13px;
            resize: vertical;
        }

        textarea:focus,
        input:focus,
        select:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.15);
        }

        textarea {
            min-height: 80px;
        }

        .row {
            display: flex;
            gap: 12px;
        }

        .row > .col {
            flex: 1;
        }

        .buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 4px;
            margin-bottom: 12px;
        }

        button {
            border-radius: 999px;
            border: none;
            padding: 6px 14px;
            font-size: 13px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background-color: #2563eb;
            color: #ffffff;
        }

        button.secondary {
            background-color: #e5e7eb;
            color: #111827;
        }

        button:disabled {
            opacity: 0.65;
            cursor: default;
        }

        .output {
            margin-top: 8px;
            padding: 10px 12px;
            border-radius: 8px;
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 280px;
            overflow: auto;
        }

        .output-title {
            font-size: 12px;
            margin-top: 4px;
            margin-bottom: 4px;
            color: #6b7280;
        }

        .hint {
            font-size: 11px;
            color: #9ca3af;
            margin-top: 2px;
        }

        .error {
            color: #b91c1c;
        }

        @media (max-width: 768px) {
            .app-root {
                margin: 12px;
                padding: 16px;
            }

            .row {
                flex-direction: column;
            }

            .tabs {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
<div class="app-root">
    <h1>Local AI Agents</h1>
    <p class="subtitle">ê°„ë‹¨í•œ ì›¹ UIë¡œ Email / DevDoc ì—ì´ì „íŠ¸ë¥¼ ë°”ë¡œ í˜¸ì¶œí•´ ë³´ì„¸ìš”.</p>

    <div class="tabs">
        <div class="tab active" data-tab="email">
            <span>ğŸ’Œ</span><span>Email Agent</span>
        </div>
        <div class="tab" data-tab="devdoc">
            <span>ğŸ“–</span><span>DevDoc Agent</span>
        </div>
    </div>

    <!-- Email Agent Tab -->
    <div class="tab-content active" id="tab-email">
        <div class="section">
            <div class="section-title">1. í•œê¸€ ë©”ì¼ ì´ˆì•ˆ</div>
            <label for="email-korean-draft">í•œê¸€ ì´ˆì•ˆ</label>
            <textarea id="email-korean-draft" placeholder="ì˜ˆ) ì–´ì œ íšŒì˜ ë‚´ìš© ê´€ë ¨í•´ì„œ í›„ì† ì¡°ì¹˜ ë©”ì¼ì„ ë³´ë‚´ê³  ì‹¶ì–´..."></textarea>
            <div class="hint">í•œê¸€ë¡œ ììœ ë¡­ê²Œ ì´ˆì•ˆì„ ì ì–´ ì£¼ì„¸ìš”.</div>
        </div>

        <div class="section row">
            <div class="col">
                <label for="email-tone">tone (ì–´ì¡°)</label>
                <select id="email-tone">
                    <option value="soft">soft (ë¶€ë“œëŸ½ê²Œ)</option>
                    <option value="formal">formal (ê²©ì‹ ìˆê²Œ)</option>
                    <option value="direct">direct (ì§ì„¤ì ìœ¼ë¡œ)</option>
                </select>
            </div>
            <div class="col">
                <label for="email-mail-type">mailType (ë©”ì¼ ìœ í˜•)</label>
                <select id="email-mail-type">
                    <option value="AUTO">AUTO (ìë™ ê°ì§€)</option>
                    <option value="NEW">NEW (ìƒˆ ë©”ì¼)</option>
                    <option value="REPLY">REPLY (ë‹µì¥)</option>
                    <option value="APOLOGY">APOLOGY (ì‚¬ê³¼)</option>
                    <option value="REMINDER">REMINDER (ë¦¬ë§ˆì¸ë“œ)</option>
                </select>
            </div>
        </div>

        <div class="section">
            <label for="email-additional-context">ì¶”ê°€ ë°°ê²½ / ìš”ì²­ ì‚¬í•­</label>
            <textarea id="email-additional-context" placeholder="ìˆ˜ì‹ ì ì •ë³´, íšŒì‚¬/í”„ë¡œì íŠ¸ ë§¥ë½, ê¼­ ë“¤ì–´ê°”ìœ¼ë©´ í•˜ëŠ” ë¬¸ì¥ ë“±ì„ ì ì–´ ì£¼ì„¸ìš”."></textarea>
        </div>

        <div class="section">
            <div class="buttons">
                <button id="btn-generate-email">
                    <span>ì˜ì–´ ë©”ì¼ ì´ˆì•ˆ ìƒì„±</span>
                </button>
            </div>
            <div class="output-title">ìƒì„±ëœ ì˜ì–´ ë©”ì¼ / ë©”íƒ€ ì •ë³´</div>
            <div id="email-draft-output" class="output"></div>
        </div>

        <div class="section">
            <div class="section-title">2. ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
            <label for="email-english-mail">ì²´í¬í•  ì˜ì–´ ë©”ì¼ ë‚´ìš©</label>
            <textarea id="email-english-mail" placeholder="ìœ„ì—ì„œ ìƒì„±ëœ ë©”ì¼ì´ ìë™ìœ¼ë¡œ ë“¤ì–´ì˜µë‹ˆë‹¤. ì§ì ‘ ìˆ˜ì •í•˜ê±°ë‚˜ ë¶™ì—¬ë„£ì–´ë„ ë©ë‹ˆë‹¤."></textarea>

            <div class="buttons">
                <button id="btn-email-checklist" class="secondary">
                    <span>ì²´í¬ë¦¬ìŠ¤íŠ¸ í™•ì¸</span>
                </button>
            </div>

            <div class="output-title">ì²´í¬ë¦¬ìŠ¤íŠ¸ ê²°ê³¼</div>
            <div id="email-checklist-output" class="output"></div>
        </div>
    </div>

    <!-- DevDoc Agent Tab -->
    <div class="tab-content" id="tab-devdoc">
        <div class="section">
            <div class="section-title">1. Q&amp;A</div>
            <label for="devdoc-question">ì§ˆë¬¸ (question)</label>
            <textarea id="devdoc-question" placeholder="ì˜ˆ) Spring Bootì—ì„œ ì •ì  ë¦¬ì†ŒìŠ¤ ë§¤í•‘ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì„¤ëª…í•´ì¤˜."></textarea>

            <div class="row">
                <div class="col">
                    <label for="devdoc-persona">persona</label>
                    <input id="devdoc-persona" type="text" placeholder="ì˜ˆ) ì´ˆë³´ ë°±ì—”ë“œ ê°œë°œì, Tech Lead ë“±" />
                </div>
                <div class="col">
                    <label for="devdoc-topic-hint">topicHint</label>
                    <input id="devdoc-topic-hint" type="text" placeholder="ì˜ˆ) Spring Boot static resource, LangChain4j" />
                </div>
            </div>

            <div class="buttons">
                <button id="btn-devdoc-qa">
                    <span>Q&amp;A ì‹¤í–‰</span>
                </button>
            </div>

            <div class="output-title">Q&amp;A ê²°ê³¼ (ìš”ì•½ / ìƒì„¸ / ì°¸ì¡° ìŠ¤ë‹ˆí«)</div>
            <div id="devdoc-qa-output" class="output"></div>
        </div>

        <div class="section">
            <div class="section-title">2. í•™ìŠµ ë…¸íŠ¸</div>
            <div class="row">
                <div class="col">
                    <label for="devdoc-topic">topic</label>
                    <input id="devdoc-topic" type="text" placeholder="ì˜ˆ) LangChain4jë¡œ RAG êµ¬ì„±í•˜ê¸°" />
                </div>
                <div class="col">
                    <label for="devdoc-note-persona">persona</label>
                    <input id="devdoc-note-persona" type="text" placeholder="ì˜ˆ) ì£¼ë‹ˆì–´ ì„œë²„ ê°œë°œì" />
                </div>
            </div>

            <div class="buttons">
                <button id="btn-devdoc-note" class="secondary">
                    <span>í•™ìŠµ ë…¸íŠ¸ ìƒì„±</span>
                </button>
            </div>

            <div class="output-title">ìƒì„±ëœ í•™ìŠµ ë…¸íŠ¸ (Markdown)</div>
            <div id="devdoc-note-output" class="output"></div>
        </div>
    </div>
</div>

<script>
    // íƒ­ ì „í™˜
    (function setupTabs() {
        const tabs = document.querySelectorAll(".tab");
        const contents = {
            email: document.getElementById("tab-email"),
            devdoc: document.getElementById("tab-devdoc")
        };

        tabs.forEach(tab => {
            tab.addEventListener("click", () => {
                const key = tab.getAttribute("data-tab");
                if (!key) return;

                tabs.forEach(t => t.classList.remove("active"));
                tab.classList.add("active");

                Object.values(contents).forEach(c => c.classList.remove("active"));
                const content = contents[key];
                if (content) content.classList.add("active");
            });
        });
    })();

    function setLoading(button, isLoading) {
        if (!button) return;
        if (isLoading) {
            button.dataset.originalText = button.textContent;
            button.textContent = "ì²˜ë¦¬ ì¤‘...";
            button.disabled = true;
        } else {
            if (button.dataset.originalText) {
                button.textContent = button.dataset.originalText;
            }
            button.disabled = false;
        }
    }

    async function postJson(url, body, outputElement, button) {
        if (!outputElement) return;
        setLoading(button, true);
        outputElement.textContent = "ìš”ì²­ ì¤‘...";
        try {
            const response = await fetch(url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(body)
            });

            const text = await response.text();
            let parsed;

            try {
                parsed = JSON.parse(text);
            } catch (_) {
                parsed = text;
            }

            if (!response.ok) {
                outputElement.innerHTML =
                    "<span class='error'>ìš”ì²­ ì‹¤íŒ¨ (" + response.status + ")</span>\n" +
                    (typeof parsed === "string" ? parsed : JSON.stringify(parsed, null, 2));
                return;
            }

            if (typeof parsed === "string") {
                outputElement.textContent = parsed;
            } else {
                outputElement.textContent = JSON.stringify(parsed, null, 2);
            }
        } catch (e) {
            outputElement.innerHTML = "<span class='error'>ì—ëŸ¬:</span> " + e;
        } finally {
            setLoading(button, false);
        }
    }

    // Email Agent: ì´ˆì•ˆ ìƒì„±
    (function setupEmailDraft() {
        const btn = document.getElementById("btn-generate-email");
        const koreanDraftEl = document.getElementById("email-korean-draft");
        const toneEl = document.getElementById("email-tone");
        const mailTypeEl = document.getElementById("email-mail-type");
        const contextEl = document.getElementById("email-additional-context");
        const outputEl = document.getElementById("email-draft-output");
        const englishMailEl = document.getElementById("email-english-mail");

        if (!btn) return;

        btn.addEventListener("click", async () => {
            const body = {
                koreanDraft: koreanDraftEl.value || "",
                tone: toneEl.value || "soft",
                mailType: mailTypeEl.value || "AUTO",
                additionalContext: contextEl.value || ""
            };

            await postJson("/api/agent/email/draft", body, outputEl, btn);

            // ì‘ë‹µì´ JSONì¼ ê²½ìš° finalEnglishMailì„ ì˜ì–´ ë©”ì¼ ì…ë ¥ì°½ì— ìë™ ë°˜ì˜
            try {
                const text = outputEl.textContent || "";
                const parsed = JSON.parse(text);
                if (parsed && typeof parsed.finalEnglishMail === "string") {
                    englishMailEl.value = parsed.finalEnglishMail;
                }
            } catch (_) {
                // ignore JSON parse errors
            }
        });
    })();

    // Email Agent: ì²´í¬ë¦¬ìŠ¤íŠ¸
    (function setupEmailChecklist() {
        const btn = document.getElementById("btn-email-checklist");
        const englishMailEl = document.getElementById("email-english-mail");
        const outputEl = document.getElementById("email-checklist-output");

        if (!btn) return;

        btn.addEventListener("click", async () => {
            const body = {
                englishMail: englishMailEl.value || ""
            };

            await postJson("/api/agent/email/checklist", body, outputEl, btn);
        });
    })();

    // DevDoc Agent: Q&A
    (function setupDevDocQa() {
        const btn = document.getElementById("btn-devdoc-qa");
        const questionEl = document.getElementById("devdoc-question");
        const personaEl = document.getElementById("devdoc-persona");
        const topicHintEl = document.getElementById("devdoc-topic-hint");
        const outputEl = document.getElementById("devdoc-qa-output");

        if (!btn) return;

        btn.addEventListener("click", async () => {
            const body = {
                question: questionEl.value || "",
                persona: personaEl.value || "",
                topicHint: topicHintEl.value || ""
            };

            await postJson("/api/agent/devdoc/qa", body, outputEl, btn);
        });
    })();

    // DevDoc Agent: í•™ìŠµ ë…¸íŠ¸
    (function setupDevDocNote() {
        const btn = document.getElementById("btn-devdoc-note");
        const topicEl = document.getElementById("devdoc-topic");
        const personaEl = document.getElementById("devdoc-note-persona");
        const outputEl = document.getElementById("devdoc-note-output");

        if (!btn) return;

        btn.addEventListener("click", async () => {
            const body = {
                topic: topicEl.value || "",
                persona: personaEl.value || ""
            };

            await postJson("/api/agent/devdoc/note", body, outputEl, btn);
        });
    })();
</script>
</body>
</html>

